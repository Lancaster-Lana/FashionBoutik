(function(n){n.fn.kwicks=function(t){var r=n.extend({isVertical:!1,sticky:!1,defaultKwick:0,event:"mouseover",spacing:0,duration:500},t),u=r.isVertical?"height":"width",f=r.isVertical?"top":"left";return this.each(function(){var t,e,o;for(container=n(this),t=container.children("li"),e=t.eq(0).css(u).replace(/px/,""),r.max?r.min=(e*t.size()-r.max)/(t.size()-1):r.max=e*t.size()-r.min*(t.size()-1),r.isVertical?container.css({width:t.eq(0).css("width"),height:e*t.size()+r.spacing*(t.size()-1)+"px"}):container.css({width:e*t.size()+r.spacing*(t.size()-1)+"px",height:t.eq(0).css("height")}),o=[],i=0;i<t.size();i++)for(o[i]=[],j=1;j<t.size()-1;j++)o[i][j]=i==j?r.isVertical?j*r.min+j*r.spacing:j*r.min+j*r.spacing:(j<=i?j*r.min:(j-1)*r.min+r.max)+j*r.spacing;t.each(function(i){var s=n(this);i===0?s.css(f,"0px"):i==t.size()-1?s.css(r.isVertical?"bottom":"right","0px"):r.sticky?s.css(f,o[r.defaultKwick][i]):s.css(f,i*e+i*r.spacing);r.sticky&&(r.defaultKwick==i?(s.css(u,r.max+"px"),s.addClass("active")):s.css(u,r.min+"px"));s.css({margin:0,position:"absolute"});s.bind(r.event,function(){var n=[],h=[],c,e,l;for(t.stop().removeClass("active"),j=0;j<t.size();j++)n[j]=t.eq(j).css(u).replace(/px/,""),h[j]=t.eq(j).css(f).replace(/px/,"");c={};c[u]=r.max;e=r.max-n[i];l=n[i]/e;s.addClass("active").animate(c,{step:function(s){var c=e!=0?s/e-l:1;t.each(function(e){e!=i&&t.eq(e).css(u,n[e]-(n[e]-r.min)*c+"px");e>0&&e<t.size()-1&&t.eq(e).css(f,h[e]-(h[e]-o[i][e])*c+"px")})},duration:r.duration,easing:r.easing})})});r.sticky||container.bind("mouseleave",function(){var n=[],o=[],s,h;for(t.removeClass("active").stop(),i=0;i<t.size();i++)n[i]=t.eq(i).css(u).replace(/px/,""),o[i]=t.eq(i).css(f).replace(/px/,"");s={};s[u]=e;h=e-n[0];t.eq(0).animate(s,{step:function(s){var c=h!=0?(s-n[0])/h:1;for(i=1;i<t.size();i++)t.eq(i).css(u,n[i]-(n[i]-e)*c+"px"),i<t.size()-1&&t.eq(i).css(f,o[i]-(o[i]-(i*e+i*r.spacing))*c+"px")},duration:r.duration,easing:r.easing})})})}})(jQuery);