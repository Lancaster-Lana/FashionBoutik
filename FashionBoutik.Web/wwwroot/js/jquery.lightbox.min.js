/*!
 * jquery.lightbox.js
 * https://github.com/duncanmcdougall/Responsive-Lightbox
 * Copyright 2013 Duncan McDougall and other contributors; @license Creative Commons Attribution 2.5
 *
 * Options: 
 * margin - int - default 50. Minimum margin around the image
 * nav - bool - default true. enable navigation
 * blur - bool - default true. Blur other content when open using css filter
 * minSize - int - default 0. Min window width or height to open lightbox. Below threshold will open image in a new tab.
 *
 */
(function(n){"use strict";n.fn.lightbox=function(t){var r={margin:50,nav:!0,blur:!0,minSize:0},i={items:[],lightbox:null,image:null,current:null,locked:!1,caption:null,init:function(t){i.items=t;i.selector="lightbox-"+Math.random().toString().replace(".","");i.lightbox||(n("body").append('<div id="lightbox" style="display:none;"><a href="#" class="lightbox-close lightbox-button"><\/a><div class="lightbox-nav"><a href="#" class="lightbox-previous lightbox-button"><\/a><a href="#" class="lightbox-next lightbox-button"><\/a><\/div><div href="#" class="lightbox-caption"><p><\/p><\/div><\/div>'),i.lightbox=n("#lightbox"),i.caption=n(".lightbox-caption",i.lightbox));i.items.length>1&&r.nav?n(".lightbox-nav",i.lightbox).show():n(".lightbox-nav",i.lightbox).hide();i.bindEvents()},loadImage:function(){r.blur&&n("body").addClass("blurred");n("img",i.lightbox).remove();i.lightbox.fadeIn("fast").append('<span class="lightbox-loading"><\/span>');var t=n('<img src="'+n(i.current).attr("href")+'" draggable="false">');n(t).load(function(){n(".lightbox-loading").remove();i.lightbox.append(t);i.image=n("img",i.lightbox).hide();i.resizeImage();i.setCaption()})},setCaption:function(){var t=n(i.current).data("caption");!!t&&t.length>0?(i.caption.fadeIn(),n("p",i.caption).text(t)):i.caption.hide()},resizeImage:function(){var f,e,o,t,u;e=n(window).height()-r.margin;o=n(window).outerWidth(!0)-r.margin;i.image.width("").height("");t=i.image.height();u=i.image.width();u>o&&(f=o/u,u=o,t=Math.round(t*f));t>e&&(f=e/t,t=e,u=Math.round(u*f));i.image.width(u).height(t).css({top:(n(window).height()-i.image.outerHeight())/2+"px",left:(n(window).width()-i.image.outerWidth())/2+"px"}).show();i.locked=!1},getCurrentIndex:function(){return n.inArray(i.current,i.items)},next:function(){if(i.locked)return!1;i.locked=!0;i.getCurrentIndex()>=i.items.length-1?n(i.items[0]).click():n(i.items[i.getCurrentIndex()+1]).click()},previous:function(){if(i.locked)return!1;i.locked=!0;i.getCurrentIndex()<=0?n(i.items[i.items.length-1]).click():n(i.items[i.getCurrentIndex()-1]).click()},bindEvents:function(){n(i.items).click(function(t){if(!n("#lightbox").is(":visible")&&(n(window).width()<r.minSize||n(window).height()<r.minSize)){n(this).attr("target","_blank");return}var u=n(this)[0];t.preventDefault();i.current=u;i.loadImage();n(document).on("keydown",function(n){n.keyCode===27&&i.close();n.keyCode===39&&i.next();n.keyCode===37&&i.previous()})});i.lightbox.on("click",function(n){this===n.target&&i.close()});n(i.lightbox).on("click",".lightbox-previous",function(){return i.previous(),!1});n(i.lightbox).on("click",".lightbox-next",function(){return i.next(),!1});n(i.lightbox).on("click",".lightbox-close",function(){return i.close(),!1});n(window).resize(function(){i.image&&i.resizeImage()})},close:function(){n(document).off("keydown");n(i.lightbox).fadeOut("fast");n("body").removeClass("blurred")}};n.extend(r,t);i.init(this)}})(jQuery);